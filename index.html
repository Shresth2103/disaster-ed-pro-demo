<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DisasterED Pro - Disaster Preparedness Education</title>

    <!-- Fonts (optional, graceful fallback to system) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">🚨 DisasterED Pro</div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#demo">Demo</a></li>
                <li><a href="#about">About</a></li>
            </ul>
            <a href="#" class="btn" onclick="openModal('loginModal')" id="loginCta">Login</a>
        </nav>
    </header>

    <main>
        <section class="hero" id="home">
            <div class="container">
                <h1>Master Disaster Preparedness Through Interactive Learning</h1>
                <p>Transforming disaster education from boring theory to engaging, life-saving skills for students across India</p>
                <div class="cta-buttons">
                    <a href="#" class="btn pulse" onclick="openModal('demoModal')">Try Live Demo</a>
                    <a href="#features" class="btn" style="background: transparent; border: 2px solid white;">Learn More</a>
                </div>
            </div>
        </section>

        <section class="features" id="features">
            <div class="container">
                <h2 style="text-align: center; font-size: 2.5rem; margin-bottom: 1rem; color: #333;">Core Features</h2>
                <p style="text-align: center; font-size: 1.2rem; color: #666; margin-bottom: 3rem;">Comprehensive disaster preparedness training designed specifically for Indian schools and colleges</p>
                <div class="features-grid">
                    <div class="feature-card" onclick="showFeatureDemo('simulations')">
                        <div class="feature-icon">🌍</div>
                        <h3>Interactive Simulations</h3>
                        <p>Immersive earthquake, fire, and flood scenarios that teach students how to respond in real emergencies</p>
                        <small style="color: #667eea; font-weight: bold;">Click to see demo</small>
                    </div>
                    <div class="feature-card" onclick="showFeatureDemo('gamification')">
                        <div class="feature-icon">🎮</div>
                        <h3>Gamified Learning</h3>
                        <p>Badges, leaderboards, and progress tracking make disaster preparedness engaging and memorable</p>
                        <small style="color: #667eea; font-weight: bold;">Click to see demo</small>
                    </div>
                    <div class="feature-card" onclick="showFeatureDemo('mobile')">
                        <div class="feature-icon">📱</div>
                        <h3>Mobile-First Design</h3>
                        <p>Works seamlessly on smartphones, tablets, and computers - accessible anywhere, anytime</p>
                        <small style="color: #667eea; font-weight: bold;">Click to see demo</small>
                    </div>
                    <div class="feature-card" onclick="showFeatureDemo('certification')">
                        <div class="feature-icon">🏆</div>
                        <h3>Certification System</h3>
                        <p>Digital certificates and assessments track student progress and knowledge retention</p>
                        <small style="color: #667eea; font-weight: bold;">Click to see demo</small>
                    </div>
                    <div class="feature-card" onclick="showFeatureDemo('analytics')">
                        <div class="feature-icon">📊</div>
                        <h3>Teacher Dashboard</h3>
                        <p>Comprehensive analytics help educators track class progress and identify knowledge gaps</p>
                        <small style="color: #667eea; font-weight: bold;">Click to see demo</small>
                    </div>
                    <div class="feature-card" onclick="showFeatureDemo('localization')">
                        <div class="feature-icon">🌐</div>
                        <h3>Localized Content</h3>
                        <p>Region-specific disasters and multilingual support (English, Hindi, regional languages)</p>
                        <small style="color: #667eea; font-weight: bold;">Click to see demo</small>
                    </div>
                </div>
            </div>
        </section>

        <section class="demo-section" id="demo">
            <div class="container">
                <h2 style="font-size: 2.5rem; margin-bottom: 2rem;">Experience the Platform</h2>

                <div class="demo-container">
                    <h3 style="color: #667eea; margin-bottom: 1rem;">Student Dashboard Preview</h3>

                    <div class="stats">
                        <div class="stat-card" style="background: rgba(102, 126, 234, 0.1); color: #333;">
                            <span class="stat-number" id="preparednessScore">85%</span>
                            <span>Preparedness Score</span>
                        </div>
                        <div class="stat-card" style="background: rgba(118, 75, 162, 0.1); color: #333;">
                            <span class="stat-number" id="badgesEarned">12</span>
                            <span>Badges Earned</span>
                        </div>
                        <div class="stat-card" style="background: rgba(34, 197, 94, 0.1); color: #333;">
                            <span class="stat-number" id="modulesCompleted">7</span>
                            <span>Modules Completed</span>
                        </div>
                    </div>

                    <div class="simulation-demo">
                        <h4>🔥 Fire Safety Module - Progress</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 75%"></div>
                        </div>
                        <p><strong>Current Topic:</strong> Evacuation Route Planning</p>
                        <p><strong>Next:</strong> Fire Extinguisher Usage</p>
                        <button class="btn" style="margin-top: 1rem;" onclick="startSimulation()">Continue Learning</button>
                    </div>

                    <div class="simulation-demo">
                        <h4>🌊 Flood Response Module</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 45%"></div>
                        </div>
                        <p><strong>Status:</strong> In Progress</p>
                        <p><strong>Next Milestone:</strong> Emergency Kit Preparation</p>
                        <button class="btn" style="margin-top: 1rem; background: #64748b;" onclick="openModal('floodQuiz')">Take Assessment</button>
                    </div>
                </div>

                <div style="margin-top: 3rem;">
                    <button class="btn" onclick="openModal('demoModal')" style="font-size: 1.2rem; padding: 1rem 2rem;">🚀 Try Interactive Demo</button>
                </div>
            </div>
        </section>

        <section style="background: white; padding: 5rem 0;" id="about">
            <div class="container">
                <h2 style="text-align: center; font-size: 2.5rem; margin-bottom: 3rem; color: #333;">Why DisasterED Pro?</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                    <div style="text-align: center;">
                        <h3 style="color: #667eea; margin-bottom: 1rem;">📈 Proven Impact</h3>
                        <p>85% improvement in disaster preparedness knowledge retention compared to traditional methods</p>
                    </div>
                    <div style="text-align: center;">
                        <h3 style="color: #667eea; margin-bottom: 1rem;">🎯 Targeted Solution</h3>
                        <p>Specifically designed for Indian educational institutions with localized disaster scenarios</p>
                    </div>
                    <div style="text-align: center;">
                        <h3 style="color: #667eea; margin-bottom: 1rem;">🔄 Scalable Platform</h3>
                        <p>Easily deployable across schools nationwide with minimal infrastructure requirements</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Demo Modal -->
    <div id="demoModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('demoModal')">&times;</span>
            <h2 style="color: #667eea; margin-bottom: 1rem;">🔥 Fire Safety Simulation</h2>
            <p style="margin-bottom: 1rem;"><strong>Scenario:</strong> You're in your classroom when the fire alarm rings. What's your first action?</p>
            <div class="quiz-container">
                <div class="quiz-option" onclick="selectOption(this, false)">🏃‍♂️ Run to the nearest exit immediately</div>
                <div class="quiz-option" onclick="selectOption(this, false)">📱 Call your parents first</div>
                <div class="quiz-option" onclick="selectOption(this, true)">✋ Stop, listen to teacher's instructions, and follow evacuation protocol</div>
                <div class="quiz-option" onclick="selectOption(this, false)">🎒 Pack your belongings quickly</div>
            </div>
            <div id="quiz-feedback" style="margin-top: 1rem; font-weight: bold; display: none;"></div>
            <button class="btn" onclick="nextSimulation()" style="margin-top: 1rem; display: none;" id="nextBtn">Next Scenario →</button>
        </div>
    </div>

    <!-- Flood Quiz Modal -->
    <div id="floodQuiz" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('floodQuiz')">&times;</span>
            <h2 style="color: #667eea; margin-bottom: 1rem;">🌊 Flood Preparedness Assessment</h2>
            <p style="margin-bottom: 1rem;"><strong>Question:</strong> What should be in your emergency kit for flood preparedness?</p>
            <div class="quiz-container">
                <div class="quiz-option" onclick="selectOption(this, false, 'flood-feedback')">🍫 Snacks and drinks only</div>
                <div class="quiz-option" onclick="selectOption(this, true, 'flood-feedback')">💧 Water, first aid, flashlight, battery radio, emergency contacts</div>
                <div class="quiz-option" onclick="selectOption(this, false, 'flood-feedback')">📚 School books and laptop</div>
                <div class="quiz-option" onclick="selectOption(this, false, 'flood-feedback')">🎮 Games and entertainment</div>
            </div>
            <div id="flood-feedback" style="margin-top: 1rem; font-weight: bold; display: none;"></div>
        </div>
    </div>

    <!-- Login Modal (enhanced with IDs for Firebase) -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2 style="color: #667eea; margin-bottom: 1rem;" id="authTitle">Login to DisasterED Pro</h2>
            <form style="display: flex; flex-direction: column; gap: 1rem;" onsubmit="handleLogin(event)">
                <input type="email" id="loginEmail" placeholder="Email Address" style="padding: 1rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem;" required>
                <input type="password" id="loginPassword" placeholder="Password" style="padding: 1rem; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem;" required>
                <button type="submit" class="btn" id="authSubmitBtn">Sign In</button>
            </form>
            <p style="text-align: center; margin-top: 1rem; color: #666;">
                <span id="authToggleCopy">New user?</span>
                <a href="#" style="color: #667eea;" onclick="toggleAuthMode(event)" id="authToggleLink">Create Account</a>
            </p>
        </div>
    </div>

    <!-- Feature Demo Modal -->
    <div id="featureModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeModal('featureModal')">&times;</span>
            <div id="featureContent"><!-- Content will be dynamically loaded --></div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 DisasterED Pro - Smart India Hackathon 2025 Project</p>
            <p>Developed by AlgoAces | Problem Statement: SIH25008</p>
        </div>
    </footer>

    <!-- UI / Demo Logic (non-module) -->
    <script>
        function openModal(modalId) { document.getElementById(modalId).style.display = 'flex'; }
        function closeModal(modalId) { document.getElementById(modalId).style.display = 'none'; }

        function selectOption(element, isCorrect, feedbackId) {
            const options = element.parentNode.querySelectorAll('.quiz-option');
            options.forEach(opt => { opt.classList.remove('correct', 'incorrect'); opt.style.pointerEvents = 'none'; });

            const msgCorrect = '✅ Correct! Following teacher\'s instructions ensures orderly evacuation and everyone\'s safety.';
            const msgWrong = '❌ Not quite right. Always follow your teacher\'s evacuation instructions for safety.';

            if (isCorrect) {
                element.classList.add('correct');
                showFeedback(msgCorrect, 'green', feedbackId);
            } else {
                element.classList.add('incorrect');
                options.forEach(opt => { if (opt.onclick && opt.onclick.toString().includes('true')) opt.classList.add('correct'); });
                showFeedback(msgWrong, 'red', feedbackId);
            }
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) nextBtn.style.display = 'inline-block';
        }

        function showFeedback(message, color, feedbackId) {
            const targetId = feedbackId || 'quiz-feedback';
            const feedback = document.getElementById(targetId);
            if (!feedback) return;
            feedback.textContent = message; feedback.style.color = color; feedback.style.display = 'block';
        }

        function nextSimulation() {
            alert('🎉 Great job! In the full platform, you\'d continue to the next disaster scenario. Your progress has been saved!');
            if (window.saveModuleProgress) { try { window.saveModuleProgress('fireSafety', 75); } catch (e) {} }
            closeModal('demoModal');
        }

        function startSimulation() {
            alert('🔥 Fire Safety Simulation Starting...\n\nIn the full version, this would launch an interactive 3D simulation where you navigate through evacuation procedures!');
        }

        // Feature Demos
        function showFeatureDemo(feature) {
            const content = document.getElementById('featureContent');
            const demoContent = {
                'simulations': `
                    <h2 style="color: #667eea; margin-bottom: 1rem;">🌍 Interactive Simulations Demo</h2>
                    <div style="background: #f8fafc; padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                        <h3>🔥 Fire Evacuation Simulation</h3>
                        <p><strong>Scenario:</strong> School fire alarm activated</p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                            <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <strong>Step 1:</strong> Stop current activity<br>
                                <small>✅ Completed in 2 seconds</small>
                            </div>
                            <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                <strong>Step 2:</strong> Listen to instructions<br>
                                <small>⏳ In progress...</small>
                            </div>
                        </div>
                        <button class="btn" onclick="alert('🎮 In the full version, this would launch a 3D interactive simulation!')">Launch 3D Simulation</button>
                    </div>
                `,
                'gamification': `
                    <h2 style="color: #667eea; margin-bottom: 1rem;">🎮 Gamified Learning Demo</h2>
                    <div style="background: #f8fafc; padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                        <h3>Student Achievement System</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
                            <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                <div style="font-size: 2rem;">🏅</div>
                                <strong>Fire Safety Expert</strong><br>
                                <small>Earned: Dec 2024</small>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                <div style="font-size: 2rem;">🌊</div>
                                <strong>Flood Response Pro</strong><br>
                                <small>75% Progress</small>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px; opacity: 0.6;">
                                <div style="font-size: 2rem;">🌍</div>
                                <strong>Earthquake Master</strong><br>
                                <small>Locked</small>
                            </div>
                        </div>
                        <div style="margin-top: 1rem;">
                            <strong>Current Streak: 7 days</strong> 🔥<br>
                            <small>Class Ranking: #3 out of 45 students</small>
                        </div>
                    </div>
                `,
                'analytics': `
                    <h2 style="color: #667eea; margin-bottom: 1rem;">📊 Teacher Dashboard Demo</h2>
                    <div style="background: #f8fafc; padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                        <h3>Class 10-A Performance Overview</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin: 1rem 0;">
                            <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                <div style="font-size: 1.5rem; color: #22c55e; font-weight: bold;">78%</div>
                                <small>Average Score</small>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                <div style="font-size: 1.5rem; color: #3b82f6; font-weight: bold;">42/45</div>
                                <small>Active Students</small>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: white; border-radius: 8px;">
                                <div style="font-size: 1.5rem; color: #f59e0b; font-weight: bold;">3</div>
                                <small>Need Attention</small>
                            </div>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                            <strong>Recent Activity:</strong><br>
                            • Rahul completed Fire Safety module<br>
                            • Priya earned "First Aid Expert" badge<br>
                            • 5 students need to retake earthquake quiz<br>
                        </div>
                    </div>
                `,
                'certification': `
                    <h2 style="color: #667eea; margin-bottom: 1rem;">🏆 Digital Certification Demo</h2>
                    <div class="cert-card">
                        <div class="cert-inner">
                            <h3 style="margin-bottom: .5rem;">CERTIFICATE OF COMPLETION</h3>
                            <p style="font-size: 1.2rem; margin: .75rem 0;">This certifies that</p>
                            <p style="font-size: 1.6rem; font-weight: 700;">{{ Student Name }}</p>
                            <p style="margin: .75rem 0;">has successfully completed the <strong>Fire Safety</strong> module with distinction.</p>
                            <p class="badge">Issued: Jan 2025 • ID: CERT-XS29F</p>
                        </div>
                        <div style="margin-top: 1rem;">
                            <button class="btn" onclick="alert('🎓 In production, this will generate a signed digital certificate (PDF) with a verification QR.')">Generate PDF</button>
                        </div>
                    </div>
                `,
                'mobile': `
                    <h2 style="color: #667eea; margin-bottom: 1rem;">📱 Mobile-First Experience</h2>
                    <div style="background:#f8fafc; padding:1.5rem; border-radius:10px;">
                        <p>Optimized layout scales beautifully on phones and tablets. Touch-friendly buttons, large tap targets, and offline-ready modules (PWA-ready in roadmap).</p>
                        <ul style="margin-top: .75rem; padding-left: 1.25rem;">
                            <li>Responsive grid & typography</li>
                            <li>Accessible contrast & focus states</li>
                            <li>Low bandwidth friendly assets</li>
                        </ul>
                    </div>
                `,
                'localization': `
                    <h2 style="color: #667eea; margin-bottom: 1rem;">🌐 Localization & Regional Content</h2>
                    <div style="background:#f8fafc; padding:1.5rem; border-radius:10px;">
                        <p>Content tailored to Indian regions, hazards, and languages. Example pack:</p>
                        <ul style="margin-top: .75rem; padding-left: 1.25rem;">
                            <li>Hindi, English (with roadmap for Marathi, Bengali, Tamil, Telugu)</li>
                            <li>Region-specific scenarios: Floods (Assam), Cyclones (Odisha), Earthquakes (Himalayan belt)</li>
                            <li>Local emergency contacts and drill templates</li>
                        </ul>
                    </div>
                `
            };
            content.innerHTML = demoContent[feature] || '<p>Demo coming soon.</p>';
            openModal('featureModal');
        }

        // Auth modal toggling (login/signup) — UI only; actions handled in Firebase block
        let authMode = 'login';
        function toggleAuthMode(e){
            if (e) e.preventDefault();
            authMode = authMode === 'login' ? 'signup' : 'login';
            document.getElementById('authTitle').textContent = authMode === 'login' ? 'Login to DisasterED Pro' : 'Create your DisasterED Pro account';
            document.getElementById('authSubmitBtn').textContent = authMode === 'login' ? 'Sign In' : 'Sign Up';
            document.getElementById('authToggleCopy').textContent = authMode === 'login' ? 'New user?' : 'Already have an account?';
            document.getElementById('authToggleLink').textContent = authMode === 'login' ? 'Create Account' : 'Sign In';
        }

        // This is intercepted by Firebase block below
        function handleLogin(event){ event.preventDefault(); }
    </script>

    <!-- Firebase SDK & App Logic (module) -->
    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  // ✅ Correct Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyBK9TZzazFtV26JcjQUngrEdsyw87f1uXc",
    authDomain: "disastered-pro-demo.firebaseapp.com",
    projectId: "disastered-pro-demo",
    storageBucket: "disastered-pro-demo.appspot.com",  // fixed
    messagingSenderId: "750943106849",
    appId: "1:750943106849:web:09ae61b28c4c964c887060",
    measurementId: "G-C8C2DCF7T0"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // --- Modal helpers ---
  window.openModal = (id) => {
    document.getElementById(id).style.display = "block";
  };
  window.closeModal = (id) => {
    document.getElementById(id).style.display = "none";
  };

  // --- Sign up ---
  window.handleSignup = async () => {
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;
    try {
      await createUserWithEmailAndPassword(auth, email, password);
      alert("✅ Signed up as " + email);
      closeModal("loginModal");
    } catch (err) {
      alert("❌ " + err.message);
    }
  };

  // --- Login ---
  window.handleLogin = async (event) => {
    event.preventDefault();
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;
    try {
      await signInWithEmailAndPassword(auth, email, password);
      alert("🎓 Welcome " + email);
      closeModal("loginModal");
    } catch (err) {
      alert("❌ " + err.message);
    }
  };

  // --- Save demo/module progress ---
  window.saveModuleProgress = async (moduleName, score) => {
    const user = auth.currentUser;
    if (!user) {
      alert("⚠️ Please login first!");
      return;
    }
    try {
      await setDoc(
        doc(db, "progress", user.uid),
        { [moduleName]: score, updatedAt: new Date() },
        { merge: true }
      );
      alert("✅ Progress saved for " + moduleName);
    } catch (err) {
      console.error(err);
      alert("❌ Failed to save progress");
    }
  };

  // --- Logout ---
  window.handleLogout = async () => {
    await signOut(auth);
    alert("👋 Logged out");
  };
</script>
